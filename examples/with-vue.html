<html>
  <head>
    <title>With Vue</title>
    <link rel="stylesheet" href="/styles.css" />
    <script type="module" src="https://jspm.dev/es-module-shims"></script>
  </head>
  <body>
    <script type="module"></script>

    <div id="game">
      <three-game>
        <three-ambient-light intensity="0.2"></three-ambient-light>
        <three-directional-light intensity="0.8" position="10, 10, 50"></three-directional-light>

        <rotating-dodecahedron></rotating-dodecahedron>
      </three-game>
    </div>

    <script type="text/x-template" id="rotating-dodecahedron-template">
      <three-mesh ref="mesh">
        <three-dodecahedron-buffer-geometry></three-dodecahedron-buffer-geometry>
        <three-mesh-standard-material color="hotpink"></three-mesh-standard-material>
      </three-mesh>
    </script>

    <!-- Here's a simple Three.js scene. -->

    <!-- Import dependencies via ESM. The future is now! -->
    <script type="module">
      import Vue from "https://jspm.dev/vue@3"
      importShim("/dist/index.esm.js").then(() => {
        const app = Vue.createApp({})

        /* Stop Vue from complaining about our beautiful custom elements. */
        app.config.isCustomElement = (tag) => tag.startsWith("three-")

        app.component("rotating-dodecahedron", {
          template: "#rotating-dodecahedron-template",

          mounted() {
            const { object } = this.$el

            this.$el.onupdate = (dt) => {
              object.rotation.z = object.rotation.x += 0.03
              object.scale.setScalar(4 + Math.cos(Date.now() / 200) * 0.8)
            }
          }
        })

        /* Let's go! */
        app.mount("#game")
      })
    </script>

    <script type="importmap-shim">
      {
        "imports": {
          "three": "https://jspm.dev/three",
          "three/": "https://jspm.dev/three/"
        }
      }
    </script>
  </body>
</html>
